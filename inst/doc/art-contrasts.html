<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Matthew Kay, Lisa A. Elkin, Jacob O. Wobbrock" />

<meta name="date" content="2025-04-10" />

<title>Contrast tests with ART</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Contrast tests with ART</h1>
<h4 class="author">Matthew Kay, Lisa A. Elkin, Jacob O. Wobbrock</h4>
<h4 class="date">2025-04-10</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The aligned-rank transform (ART) allows for non-parametric analyses
of variance (<a href="https://doi.org/10.1145/1978942.1978963">Wobbrock
et al. 2011</a>). But how should we do contrast tests with ART?</p>
<p>Contrasts involving levels of single factors, combinations of
factors, or differences of differences across two factors can be
performed by conducting those contrasts on a linear model
aligned-and-ranked on the factors involved in the contrasts. This linear
model may be one of the models used in the ART procedure, or it may
require concatenating factors and constructing a new model, a procedure
called <em>ART contrasts</em> or <em>ART-C</em> (<a href="https://dx.doi.org/10.1145/3472749.3474784">Elkin et
al. 2021</a>).</p>
<p>The <code>art.con()</code> function selects the appropriate model
given a desired set of contrasts and then performs the requested
contrasts. This page explains when and why a separate
aligning-and-ranking procedure is needed to conduct contrasts and
demonstrates how to conduct those contrasts using the
<code>art.con()</code> function within the ART paradigm.</p>
<p>If you are not sure when/how to select the appropriate
aligned-and-ranked linear model for a given contrast (i.e. when to use
ART versus ART-C), the <code>art.con()</code> function demonstrated in
this vignette will select the appropriate method given a contrast
specification.</p>
</div>
<div id="contents" class="section level2">
<h2>Contents</h2>
<ol style="list-style-type: decimal">
<li><a href="#test-dataset">Test Dataset</a>: Description of the test
data we will use to compare a linear model against ART</li>
<li><a href="#contrast-tests-of-main-effects">Contrast tests of main
effects</a>: Demo of conducting contrasts within a single factor (no
interaction)</li>
<li><a href="#tests-of-differences-in-pairwise-combinations-of-levels-between-factors-in-interactions">Tests
of differences in pairwise combinations of levels between factors in
interactions</a>: This type of interaction contrast must be conducted
with ART-C</li>
<li><a href="#tests-of-differences-of-differences-in-interactions">Tests
of differences of differences in interactions</a>: This type of
interaction contrast can be conducted with ART</li>
</ol>
</div>
<div id="libraries-needed-for-this-vignette" class="section level2">
<h2>Libraries needed for this vignette</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)      <span class="co">#data_frame, %&gt;%, filter, summarise, group_by</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(emmeans)    <span class="co">#emmeans, contrast</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(phia)       <span class="co">#testInteractions</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)      <span class="co">#spread</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(ARTool)     <span class="co">#art, artlm, artlm.con, art.con</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(ggplot2)    <span class="co">#ggplot, stat_..., geom_..., etc</span></span></code></pre></div>
</div>
<div id="test-dataset" class="section level2">
<h2>Test dataset</h2>
<p>Let’s generate some test data where we actually know what the effects
are. Specifically,</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>n_per_group <span class="ot">=</span> <span class="dv">150</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">X1 =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, n_per_group), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, n_per_group))),</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">X2 =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>), n_per_group <span class="sc">*</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)),</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">rnorm</span>(</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    n_per_group <span class="sc">*</span> <span class="dv">2</span>, </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    (X1 <span class="sc">==</span> <span class="st">&quot;B&quot;</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span> (X2 <span class="sc">==</span> <span class="st">&quot;D&quot;</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> (X1 <span class="sc">==</span> <span class="st">&quot;B&quot;</span> <span class="sc">&amp;</span> X2 <span class="sc">==</span> <span class="st">&quot;D&quot;</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> (X1 <span class="sc">==</span> <span class="st">&quot;A&quot;</span> <span class="sc">&amp;</span> X2 <span class="sc">==</span> <span class="st">&quot;D&quot;</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> (X2 <span class="sc">==</span> <span class="st">&quot;E&quot;</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  ) </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>)</span></code></pre></div>
<p>This is normally-distributed error with the same variance at all
levels, so we can compare the results of ART and ART-C to a linear
model, which will correctly estimate the effects.</p>
<p>I pre-ran the above code and saved it as
<code>InteractionTestData</code> so that the text here is
consistent:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">data</span>(InteractionTestData, <span class="at">package =</span> <span class="st">&quot;ARTool&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>df <span class="ot">=</span> InteractionTestData    <span class="co">#save some typing</span></span></code></pre></div>
<p>The “true” means from the model look like this:</p>
<table>
<thead>
<tr class="header">
<th align="center">X1</th>
<th align="center">X2</th>
<th align="center">Mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">A</td>
<td align="center">C or D</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">A</td>
<td align="center">E</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">B</td>
<td align="center">C</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">B</td>
<td align="center">D</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">B</td>
<td align="center">E</td>
<td align="center">3</td>
</tr>
</tbody>
</table>
<p>Which we can see pretty well:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># variant of the Dark2 colorbrewer scale with specific name mappings (so </span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># we can keep color -&gt; name mapping consistent throughout this document)</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>palette <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#1b9e77&quot;</span>, <span class="st">&quot;#d95f02&quot;</span>, <span class="st">&quot;#7570b3&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">names</span>(palette) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y, <span class="at">color =</span> X2)) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">adjust =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="st">&quot;-&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> X2), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">group =</span> <span class="cn">NA</span>), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">pch =</span> <span class="st">&quot;+&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>), <span class="at">minor_breaks =</span> <span class="sc">-</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>, <span class="at">values =</span> palette) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> X2)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>And “true” means for each level (averaging over the levels of the
other factor):</p>
<table>
<thead>
<tr class="header">
<th align="center">Level</th>
<th align="center">Mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">X1 == A</td>
<td align="center">0.66666</td>
</tr>
<tr class="even">
<td align="center">X1 == B</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">X2 == C</td>
<td align="center">0.5</td>
</tr>
<tr class="even">
<td align="center">X2 == D</td>
<td align="center">2.5</td>
</tr>
<tr class="odd">
<td align="center">X2 == E</td>
<td align="center">2.5</td>
</tr>
</tbody>
</table>
<p>Let’s fit a linear model:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>m.linear <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">data =</span> df)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">anova</span>(m.linear)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Y
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## X1          1 445.50  445.50  439.44 &lt; 2.2e-16 ***
## X2          2 236.44  118.22  116.61 &lt; 2.2e-16 ***
## X1:X2       2 270.40  135.20  133.36 &lt; 2.2e-16 ***
## Residuals 294 298.06    1.01                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Now with ART:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>m.art <span class="ot">=</span> <span class="fu">art</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">data =</span> df)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">anova</span>(m.art)</span></code></pre></div>
<pre><code>## Analysis of Variance of Aligned Rank Transformed Data
## 
## Table Type: Anova Table (Type III tests) 
## Model: No Repeated Measures (lm)
## Response: art(Y)
## 
##         Df Df.res F value     Pr(&gt;F)    
## 1 X1     1    294  488.33 &lt; 2.22e-16 ***
## 2 X2     2    294  114.35 &lt; 2.22e-16 ***
## 3 X1:X2  2    294  145.65 &lt; 2.22e-16 ***
## ---
## Signif. codes:   0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Both have significance at all levels (expected given the number of
samples and the “true” effects) and similar enough F values. The real
question is whether/what kind of contrast tests make sense.</p>
<div id="contrast-tests-of-main-effects" class="section level3">
<h3>Contrast tests of main effects</h3>
<p>For the main effects, let’s look at contrast tests for the linear
model:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(m.linear, <span class="sc">~</span> X1), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate    SE  df t.ratio p.value
##  A - B       -2.44 0.116 294 -20.963  &lt;.0001
## 
## Results are averaged over the levels of: X2</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(m.linear, <span class="sc">~</span> X2), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate    SE  df t.ratio p.value
##  C - D     -1.9121 0.142 294 -13.428  &lt;.0001
##  C - E     -1.8530 0.142 294 -13.013  &lt;.0001
##  D - E      0.0592 0.142 294   0.415  0.9093
## 
## Results are averaged over the levels of: X1 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>
<p>These are about right: The “true” effect for <code>A - B</code> is
<code>-2.3333</code>, for <code>C - D</code> and <code>C - E</code> is
<code>-2</code>, and for <code>D - E</code> is <code>0</code> (see table
above). For ART, <code>artlm()</code> will return the appropriate linear
model for single-factor contrasts, which we can then use with a library
that does contrasts (such as <code>emmeans()</code>):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># this works for single factors, though it is better (more general) to use</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co"># artlm.con() or art.con() (see below)</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(<span class="fu">artlm</span>(m.art, <span class="st">&quot;X1&quot;</span>), <span class="sc">~</span> X1), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate   SE  df t.ratio p.value
##  A - B        -137 6.19 294 -22.098  &lt;.0001
## 
## Results are averaged over the levels of: X2</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(<span class="fu">artlm</span>(m.art, <span class="st">&quot;X2&quot;</span>), <span class="sc">~</span> X2), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate   SE  df t.ratio p.value
##  C - D     -123.13 9.28 294 -13.272  &lt;.0001
##  C - E     -119.81 9.28 294 -12.914  &lt;.0001
##  D - E        3.32 9.28 294   0.358  0.9319
## 
## Results are averaged over the levels of: X1 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>
<p>This is about right (effects in the same direction, the estimates
aren’t the same because they are on the scale of ranks and not the data,
but the t values are similar to the linear model, as we should hope).
However, we recommend using <code>artlm.con()</code> instead of
<code>artlm()</code>, as it will also return the correct model in this
case but not in the general case, as we will see below. Using
<code>artlm.con()</code>, we get the same result as before:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(<span class="fu">artlm.con</span>(m.art, <span class="st">&quot;X1&quot;</span>), <span class="sc">~</span> X1), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate   SE  df t.ratio p.value
##  A - B        -137 6.19 294 -22.098  &lt;.0001
## 
## Results are averaged over the levels of: X2</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(<span class="fu">artlm.con</span>(m.art, <span class="st">&quot;X2&quot;</span>), <span class="sc">~</span> X2), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate   SE  df t.ratio p.value
##  C - D     -123.13 9.28 294 -13.272  &lt;.0001
##  C - E     -119.81 9.28 294 -12.914  &lt;.0001
##  D - E        3.32 9.28 294   0.358  0.9319
## 
## Results are averaged over the levels of: X1 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>
<p>We can also use the shortcut function <code>art.con()</code>, which
will perform the appropriate call to both <code>artlm.con()</code> and
<code>emmeans()</code> for the desired contrast:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">art.con</span>(m.art, <span class="st">&quot;X1&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate   SE  df t.ratio p.value
##  A - B        -137 6.19 294 -22.098  &lt;.0001
## 
## Results are averaged over the levels of: X2</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">art.con</span>(m.art, <span class="st">&quot;X2&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate   SE  df t.ratio p.value
##  C - D     -123.13 9.28 294 -13.272  &lt;.0001
##  C - E     -119.81 9.28 294 -12.914  &lt;.0001
##  D - E        3.32 9.28 294   0.358  0.9319
## 
## Results are averaged over the levels of: X1 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>
<p><strong>Within a single factor</strong> ART (i.e.,
<code>artlm()</code>) and ART-C (<code>artlm.con()</code>) are
mathematically equivalent, so the contrast tests for ART and ART-C have
the same results.</p>
</div>
<div id="tests-of-differences-in-pairwise-combinations-of-levels-between-factors-in-interactions" class="section level3">
<h3>Tests of differences in pairwise combinations of levels between
factors in interactions</h3>
<p>Now let’s look at tests of differences in combinations of levels
between factors:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(m.linear, <span class="sc">~</span> X1<span class="sc">:</span>X2), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast   estimate    SE  df t.ratio p.value
##  A C - B C -1.290161 0.201 294  -6.407  &lt;.0001
##  A C - A D -0.000506 0.201 294  -0.003  1.0000
##  A C - B D -5.113912 0.201 294 -25.395  &lt;.0001
##  A C - A E -2.044007 0.201 294 -10.150  &lt;.0001
##  A C - B E -2.952089 0.201 294 -14.660  &lt;.0001
##  B C - A D  1.289654 0.201 294   6.404  &lt;.0001
##  B C - B D -3.823751 0.201 294 -18.988  &lt;.0001
##  B C - A E -0.753846 0.201 294  -3.743  0.0030
##  B C - B E -1.661928 0.201 294  -8.253  &lt;.0001
##  A D - B D -5.113406 0.201 294 -25.392  &lt;.0001
##  A D - A E -2.043501 0.201 294 -10.148  &lt;.0001
##  A D - B E -2.951583 0.201 294 -14.657  &lt;.0001
##  B D - A E  3.069905 0.201 294  15.245  &lt;.0001
##  B D - B E  2.161823 0.201 294  10.735  &lt;.0001
##  A E - B E -0.908082 0.201 294  -4.509  0.0001
## 
## P value adjustment: tukey method for comparing a family of 6 estimates</code></pre>
<p>If we naively apply the ART procedure (using <code>artlm()</code>),
we will get incorrect results:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co">#DO NOT DO THIS!</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(<span class="fu">artlm</span>(m.art, <span class="st">&quot;X1:X2&quot;</span>), <span class="sc">~</span> X1<span class="sc">:</span>X2), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast  estimate   SE  df t.ratio p.value
##  A C - B C     76.9 12.4 294   6.202  &lt;.0001
##  A C - A D    125.1 12.4 294  10.091  &lt;.0001
##  A C - B D    -45.3 12.4 294  -3.650  0.0042
##  A C - A E    -12.1 12.4 294  -0.974  0.9258
##  A C - B E     87.2 12.4 294   7.030  &lt;.0001
##  B C - A D     48.2 12.4 294   3.889  0.0017
##  B C - B D   -122.2 12.4 294  -9.853  &lt;.0001
##  B C - A E    -89.0 12.4 294  -7.177  &lt;.0001
##  B C - B E     10.3 12.4 294   0.828  0.9623
##  A D - B D   -170.4 12.4 294 -13.742  &lt;.0001
##  A D - A E   -137.2 12.4 294 -11.066  &lt;.0001
##  A D - B E    -38.0 12.4 294  -3.062  0.0288
##  B D - A E     33.2 12.4 294   2.676  0.0832
##  B D - B E    132.4 12.4 294  10.680  &lt;.0001
##  A E - B E     99.2 12.4 294   8.004  &lt;.0001
## 
## P value adjustment: tukey method for comparing a family of 6 estimates</code></pre>
<p>Compare these to the linear model: very different results!</p>
<p>The linear model tests are easy to interpret: they tell us the
expected mean difference between combinations of levels.</p>
<p>The ART results are more difficult to interpret. Take
<code>A,C - A,D</code>, which looks like this:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="fu">filter</span>(X1 <span class="sc">==</span> <span class="st">&quot;A&quot;</span>, X2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X1<span class="sc">:</span>X2, <span class="at">y =</span> Y, <span class="at">color =</span> X2)) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">adjust =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="st">&quot;-&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>), <span class="at">minor_breaks =</span> <span class="sc">-</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>, <span class="at">values =</span> palette) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">10</span>)) </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The linear model correctly estimates this difference as approximately
<code>0</code>, which is both the true effect and what we should expect
from a visual inspection of the data. Unlike the linear model, the ART
model gives us a statistically significant difference between
<code>A,C</code> and <code>A,D</code>, which if we interpret in the same
way as the linear model is obviously incorrect.</p>
<p>The key here is to understand that ART is reporting differences with
the main effects subtracted out. That is, the <code>A,C - A,D</code>
effect is something like the difference between this combination of
levels if we first subtracted out the effect of <code>C - D</code>. We
can see this if we take the ART estimate for <code>C - D</code> in the
<code>emmeans</code> output for <code>X2</code> above
(<code>-123.13</code>) and the ART estimate for <code>A,C - A,D</code>
(<code>125.12</code>) here, we can get an approximate estimate of the
difference (<code>-123.13 + 125.12 == 1.99</code>) that is consistent
with the expected 0 (given the SE here).</p>
<p>The ART-C procedure was developed to align and rank data specifically
for contrasts involving levels from any number of factors, and is
available through <code>art.con()</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">art.con</span>(m.art, <span class="st">&quot;X1:X2&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast  estimate   SE  df t.ratio p.value
##  A,C - A,D     1.96 8.91 294   0.220  0.9999
##  A,C - A,E  -100.96 8.91 294 -11.333  &lt;.0001
##  A,C - B,C   -63.16 8.91 294  -7.090  &lt;.0001
##  A,C - B,D  -205.76 8.91 294 -23.096  &lt;.0001
##  A,C - B,E  -141.84 8.91 294 -15.921  &lt;.0001
##  A,D - A,E  -102.92 8.91 294 -11.553  &lt;.0001
##  A,D - B,C   -65.12 8.91 294  -7.310  &lt;.0001
##  A,D - B,D  -207.72 8.91 294 -23.316  &lt;.0001
##  A,D - B,E  -143.80 8.91 294 -16.141  &lt;.0001
##  A,E - B,C    37.80 8.91 294   4.243  0.0004
##  A,E - B,D  -104.80 8.91 294 -11.764  &lt;.0001
##  A,E - B,E   -40.88 8.91 294  -4.589  0.0001
##  B,C - B,D  -142.60 8.91 294 -16.007  &lt;.0001
##  B,C - B,E   -78.68 8.91 294  -8.832  &lt;.0001
##  B,D - B,E    63.92 8.91 294   7.175  &lt;.0001
## 
## P value adjustment: tukey method for comparing a family of 6 estimates</code></pre>
<p>Like the linear model, <code>art.con()</code> correctly estimates the
difference between <code>A,C - A,D</code> as approximately
<code>0</code>. In fact, its results agree with the linear model for all
contrasts conducted. (Note that the <code>art.con()</code> and linear
model results appear in a different order).</p>
<p>The syntax used above is consistent with <em>term</em> syntax used by
<code>artlm()</code>. <code>art.con()</code> also accepts the
<em>formula</em> syntax accepted by <code>emmeans::emmeans()</code>. We
can conduct the same contrasts as above using the following syntax:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">art.con</span>(m.art, <span class="sc">~</span> X1<span class="sc">*</span>X2)</span></code></pre></div>
<pre><code>##  contrast  estimate   SE  df t.ratio p.value
##  A,C - A,D     1.96 8.91 294   0.220  0.9999
##  A,C - A,E  -100.96 8.91 294 -11.333  &lt;.0001
##  A,C - B,C   -63.16 8.91 294  -7.090  &lt;.0001
##  A,C - B,D  -205.76 8.91 294 -23.096  &lt;.0001
##  A,C - B,E  -141.84 8.91 294 -15.921  &lt;.0001
##  A,D - A,E  -102.92 8.91 294 -11.553  &lt;.0001
##  A,D - B,C   -65.12 8.91 294  -7.310  &lt;.0001
##  A,D - B,D  -207.72 8.91 294 -23.316  &lt;.0001
##  A,D - B,E  -143.80 8.91 294 -16.141  &lt;.0001
##  A,E - B,C    37.80 8.91 294   4.243  0.0004
##  A,E - B,D  -104.80 8.91 294 -11.764  &lt;.0001
##  A,E - B,E   -40.88 8.91 294  -4.589  0.0001
##  B,C - B,D  -142.60 8.91 294 -16.007  &lt;.0001
##  B,C - B,E   -78.68 8.91 294  -8.832  &lt;.0001
##  B,D - B,E    63.92 8.91 294   7.175  &lt;.0001
## 
## P value adjustment: tukey method for comparing a family of 6 estimates</code></pre>
<p>We can also manually conduct the contrasts with
<code>emmeans::emmeans()</code> (or another library for running
contrasts) by first extracting the linear model with
<code>artlm.con()</code>. Note that the contrasts must be performed on
the variable constructed by <code>artlm.con()</code> with the names of
the factors involved concatenated together (<code>X1X2</code>):</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(<span class="fu">artlm.con</span>(m.art, <span class="st">&quot;X1:X2&quot;</span>), <span class="sc">~</span> X1X2), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast  estimate   SE  df t.ratio p.value
##  A,C - A,D     1.96 8.91 294   0.220  0.9999
##  A,C - A,E  -100.96 8.91 294 -11.333  &lt;.0001
##  A,C - B,C   -63.16 8.91 294  -7.090  &lt;.0001
##  A,C - B,D  -205.76 8.91 294 -23.096  &lt;.0001
##  A,C - B,E  -141.84 8.91 294 -15.921  &lt;.0001
##  A,D - A,E  -102.92 8.91 294 -11.553  &lt;.0001
##  A,D - B,C   -65.12 8.91 294  -7.310  &lt;.0001
##  A,D - B,D  -207.72 8.91 294 -23.316  &lt;.0001
##  A,D - B,E  -143.80 8.91 294 -16.141  &lt;.0001
##  A,E - B,C    37.80 8.91 294   4.243  0.0004
##  A,E - B,D  -104.80 8.91 294 -11.764  &lt;.0001
##  A,E - B,E   -40.88 8.91 294  -4.589  0.0001
##  B,C - B,D  -142.60 8.91 294 -16.007  &lt;.0001
##  B,C - B,E   -78.68 8.91 294  -8.832  &lt;.0001
##  B,D - B,E    63.92 8.91 294   7.175  &lt;.0001
## 
## P value adjustment: tukey method for comparing a family of 6 estimates</code></pre>
</div>
<div id="tests-of-differences-of-differences-in-interactions" class="section level3">
<h3>Tests of <em>differences of differences</em> in interactions</h3>
<p>You may also wish to test <em>differences of differences</em>; e.g.,
for the interaction <code>X1:X2</code>, we might ask, is the difference
<code>A - B</code> different when <code>X2 = C</code> compared to when
<code>X2 = D</code>? We can test this using the <code>interaction</code>
argument to <code>art.con()</code>. When the <code>interaction</code>
argument is supplied to art.con, differences of differences are tested
on data that has been aligned-and-ranked using the
<strong>original</strong> ART method (i.e., the data is
<strong>not</strong> aligned-and-ranked using the ART-C method, as it is
not necessary for these contrasts).</p>
<p>Before we test, let’s try to visualize what’s going on in just this
interaction:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>plot_interaction_for_X2_levels <span class="ot">=</span> <span class="cf">function</span>(...) {</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>  x2_levels <span class="ot">=</span> <span class="fu">c</span>(...)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  df. <span class="ot">=</span> <span class="fu">filter</span>(df, X2 <span class="sc">%in%</span> x2_levels)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  </span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>  X1_in_X2 <span class="ot">=</span> df. <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>    <span class="fu">group_by</span>(X1, X2) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Y =</span> <span class="fu">mean</span>(Y), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>    <span class="fu">spread</span>(X1, Y)</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>  </span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>  <span class="fu">print</span>(</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>    <span class="fu">ggplot</span>(df., <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y, <span class="at">color =</span> X2)) <span class="sc">+</span>  </span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>      <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">adjust =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="st">&quot;-&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>      <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>      <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> X2), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>      <span class="fu">geom_errorbar</span>(</span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">2.2</span>, <span class="at">ymin =</span> A, <span class="at">ymax =</span> B, <span class="at">y =</span> <span class="cn">NULL</span>),  </span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a>        <span class="at">data =</span> X1_in_X2, <span class="at">width =</span> .<span class="dv">19</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a>      <span class="fu">geom_text</span>(</span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">2.35</span>, <span class="at">y =</span> (A <span class="sc">+</span> B)<span class="sc">/</span><span class="dv">2</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;A - B |&quot;</span>, X2)), </span>
<span id="cb37-22"><a href="#cb37-22" tabindex="-1"></a>        <span class="at">data =</span> X1_in_X2, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb37-23"><a href="#cb37-23" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb37-24"><a href="#cb37-24" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>), <span class="at">minor_breaks =</span> <span class="sc">-</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb37-25"><a href="#cb37-25" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>, <span class="at">values =</span> palette[x2_levels]) <span class="sc">+</span></span>
<span id="cb37-26"><a href="#cb37-26" tabindex="-1"></a>      <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb37-27"><a href="#cb37-27" tabindex="-1"></a>      <span class="fu">facet_grid</span>(. <span class="sc">~</span> X2)</span>
<span id="cb37-28"><a href="#cb37-28" tabindex="-1"></a>  )</span>
<span id="cb37-29"><a href="#cb37-29" tabindex="-1"></a>}</span>
<span id="cb37-30"><a href="#cb37-30" tabindex="-1"></a><span class="fu">plot_interaction_for_X2_levels</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The true effect for <code>A - B | C</code> is -1, for
<code>A - B | D</code> is -5, and for
<code>(A - B | C) - (A - B | D)</code> is <code>(-1) - (-5) = 4</code>.
Visually, we’re asking if the two dashed lines in the above plot are
parallel. Equivalently, we’re asking if the vertical distance from the
mean of A to the mean of B in the left panel (when X2 == C) is the same
as the vertical distance between A and B in the right panel (when X2 ==
D). The true difference between these vertical distances (the
“difference of a difference”) is 4, which is also about what we would
estimate it to be by looking at the above plot.</p>
<p>We can get the estimate of this “difference of a difference” from the
linear model by adding <code>interaction = TRUE</code> to the same call
to <code>contrast</code> we made previously:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(m.linear, <span class="sc">~</span> X1<span class="sc">:</span>X2), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>, <span class="at">interaction =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  X1_pairwise X2_pairwise estimate    SE  df t.ratio p.value
##  A - B       C - D          3.823 0.285 294  13.425  &lt;.0001
##  A - B       C - E         -0.382 0.285 294  -1.342  0.1808
##  A - B       D - E         -4.205 0.285 294 -14.766  &lt;.0001</code></pre>
<p>Here we can interpret the row <code>A - B    C - D</code> as the
difference between (<code>A - B | C</code>) and
(<code>A - B | D</code>), which is estimated as <code>3.82</code> (close
to the true effect of 4, see the plot above).</p>
<p>We can look at a similar plot for the row
<code>A - B    C - E</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">plot_interaction_for_X2_levels</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;E&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Here the true effect for <code>A - B | C</code> is -1,
<code>A - B | E</code> is also -1, and
<code>(A - B | C) - (A - B | E)</code> is <code>0</code>. Visually, this
sample looks close to the true effects (the height of
<code>A - B | C</code> is about the same as <code>A - B | E</code>).
From the the row <code>A-B : C-E</code> above we can see that the
estimate from the linear model is ~0, as we should hope.</p>
<p>A similar visual analysis finds the estimate for row
<code>A - B    D - E</code> (~ -4.2) also to be correct (true effect is
-4):</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">plot_interaction_for_X2_levels</span>(<span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Now we look at these differences of differences in ART, using
<code>art.con()</code>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">art.con</span>(m.art, <span class="st">&quot;X1:X2&quot;</span>, <span class="at">interaction =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  X1_pairwise X2_pairwise estimate   SE  df t.ratio p.value
##  A - B       C - D          247.3 17.5 294  14.103  &lt;.0001
##  A - B       C - E          -22.3 17.5 294  -1.274  0.2036
##  A - B       D - E         -269.6 17.5 294 -15.377  &lt;.0001</code></pre>
<p>This is equivalent to:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">contrast</span>(<span class="fu">emmeans</span>(<span class="fu">artlm</span>(m.art, <span class="st">&quot;X1:X2&quot;</span>), <span class="sc">~</span> X1<span class="sc">:</span>X2), <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>, <span class="at">interaction =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  X1_pairwise X2_pairwise estimate   SE  df t.ratio p.value
##  A - B       C - D          247.3 17.5 294  14.103  &lt;.0001
##  A - B       C - E          -22.3 17.5 294  -1.274  0.2036
##  A - B       D - E         -269.6 17.5 294 -15.377  &lt;.0001</code></pre>
<p>And we see <em>t</em> values consistent with the linear model, and
consistent estimates (given the standard error). These types of
comparisons work under ART because they do not involve coefficients of
main effects (see the description of these tests in
<code>vignette(&quot;phia&quot;)</code>), thus are consistent even when ART has
stripped out the main effects.</p>
<p>If you prefer the <code>phia</code> package, the code to run the
equivalent tests using the <code>testInteractions</code> function in
<code>phia</code> instead of using <code>emmeans</code> is:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">testInteractions</span>(<span class="fu">artlm</span>(m.art, <span class="st">&quot;X1:X2&quot;</span>), <span class="at">pairwise =</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X2&quot;</span>))</span></code></pre></div>
<pre><code>## Warning in rbind(deparse.level, ...): number of columns of result, 6, is not a
## multiple of vector length 5 of arg 2</code></pre>
<pre><code>## F Test: 
## P-value adjustment method: holm
##             Value      SE      Df Sum of Sq        F Pr(&gt;F)    
## A-B : C-D  247.28  17.534       1    764342 198.8827 &lt;2e-16 ***
## A-B : C-E  -22.34  17.534       1      6238   1.6232 0.2036    
## A-B : D-E -269.62  17.534       1    908687 236.4412 &lt;2e-16 ***
## Residuals         294.000 1129896                              
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>While <code>emmeans()</code> uses <em>t</em> tests in this case,
<code>testInteractions()</code> gives the result of equivalent
<em>F</em> tests with one numerator degree of freedom (an <em>F</em>
test with <span class="math inline">\(F(1,\nu) = f\)</span> is
equivalent to a two-sided <em>t</em> test with <span class="math inline">\(t(\nu) = \sqrt{f}\)</span>). We prefer the
<em>t</em> test in this case because the <em>t</em> value preserves the
direction of the effect (its sign) and is more amenable to calculating
interpretable (ish) effect sizes like Cohen’s <em>d</em>. For an example
of the latter, see <code><a href="art-effect-size.html">vignette(“art-effect-size”)</a></code>.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
